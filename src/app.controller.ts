import { Controller, Get, HttpCode } from '@nestjs/common';
import { AppService } from './app.service';
import { HealthCheckService, TypeOrmHealthIndicator } from '@nestjs/terminus';

@Controller()
export class AppController {
  constructor(
    private readonly appService: AppService,
    private readonly health: HealthCheckService,
    private readonly db: TypeOrmHealthIndicator,
    // private readonly microservice: MicroserviceHealthIndicator
  ) {}

  /////////////////////////////////// GET ///////////////////////////////////
  @Get()
  @HttpCode(200)
  getVersion(): object {
    return {[process.env.npm_package_name]: process.env.npm_package_version};
  }

  @Get(`health`)
  @HttpCode(200)
  getHealth(): object {
    return this.health.check([
      () => this.db.pingCheck('postgresql'),
      // () => this.microservice.pingCheck<RmqOptions>('rabbitmq', rabbitmqOptions()),
    ]);
  }
  ///////////////////////////////////////////////////////////////////////////

  ////////////////////////////////// POST ///////////////////////////////////
  ///////////////////////////////////////////////////////////////////////////

  ////////////////////////////////// PATCH //////////////////////////////////
  ///////////////////////////////////////////////////////////////////////////

  /////////////////////////////////// PUT ///////////////////////////////////
  ///////////////////////////////////////////////////////////////////////////

  ///////////////////////////////// DELETE //////////////////////////////////
  ///////////////////////////////////////////////////////////////////////////

  ////////////////////////////// MessagePattern /////////////////////////////
  ///////////////////////////////////////////////////////////////////////////

  ////////////////////////////// EventPattern ///////////////////////////////
  ///////////////////////////////////////////////////////////////////////////
}
